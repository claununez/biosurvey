<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Selection of sites to be sampled in a survey, with the goal of
maximizing uniformity of points in the environment, but considering
geographic patterns of data. Sets of points that are environmentally similar
and have a disjoint pattern in geography, are selected twice (two survey
sites are placed so they consider the biggest geographic clusters)."><title>Selection of survey sites maximizing uniformity in environmental space
considering geographic structure — EG_selection • biosurvey</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selection of survey sites maximizing uniformity in environmental space
considering geographic structure — EG_selection"><meta property="og:description" content="Selection of sites to be sampled in a survey, with the goal of
maximizing uniformity of points in the environment, but considering
geographic patterns of data. Sets of points that are environmentally similar
and have a disjoint pattern in geography, are selected twice (two survey
sites are placed so they consider the biggest geographic clusters)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">biosurvey</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/biosurvey_preparing_data.html">biosurvey: Preparing data</a>
    <a class="dropdown-item" href="../articles/biosurvey_selecting_sites.html">biosurvey: Selecting sampling sites</a>
    <a class="dropdown-item" href="../articles/biosurvey_selection_with_preselected_sites.html">biosurvey: Selecting sampling sites using preselected points</a>
    <a class="dropdown-item" href="../articles/biosurvey_testing_module.html">biosurvey: Testing efficiency of selected sites</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/claununez/biosurvey/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Selection of survey sites maximizing uniformity in environmental space
considering geographic structure</h1>
      <small class="dont-index">Source: <a href="https://github.com/claununez/biosurvey/blob/HEAD/R/EG_selection.R" class="external-link"><code>R/EG_selection.R</code></a></small>
      <div class="d-none name"><code>EG_selection.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Selection of sites to be sampled in a survey, with the goal of
maximizing uniformity of points in the environment, but considering
geographic patterns of data. Sets of points that are environmentally similar
and have a disjoint pattern in geography, are selected twice (two survey
sites are placed so they consider the biggest geographic clusters).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">EG_selection</span><span class="op">(</span><span class="va">master</span>, <span class="va">n_blocks</span>, guess_distances <span class="op">=</span> <span class="cn">TRUE</span>, initial_distance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             increase <span class="op">=</span> <span class="cn">NULL</span>, max_n_samplings <span class="op">=</span> <span class="fl">1</span>, replicates <span class="op">=</span> <span class="fl">10</span>,</span>
<span>             use_preselected_sites <span class="op">=</span> <span class="cn">TRUE</span>, select_point <span class="op">=</span> <span class="st">"E_centroid"</span>,</span>
<span>             cluster_method <span class="op">=</span> <span class="st">"hierarchical"</span>, median_distance_filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             sample_for_distance <span class="op">=</span> <span class="fl">250</span>, set_seed <span class="op">=</span> <span class="fl">1</span>,</span>
<span>             verbose <span class="op">=</span> <span class="cn">TRUE</span>, force <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>master</dt>
<dd><p>master_matrix object derived from the function
<code><a href="prepare_master_matrix.html">prepare_master_matrix</a></code> or master_selection object derived from
functions <code><a href="random_selection.html">random_selection</a></code>, <code><a href="uniformG_selection.html">uniformG_selection</a></code>,
or <code><a href="uniformE_selection.html">uniformE_selection</a></code>.</p></dd>


<dt>n_blocks</dt>
<dd><p>(numeric) number of blocks to be selected to be used as the
base for further explorations. If preselected sites are used, this number must
be larger than the number of unique blocks already represented by such sites.</p></dd>


<dt>guess_distances</dt>
<dd><p>(logical) whether or not to use internal algorithm
to automatically select <code>initial_distance</code> and <code>increase</code>. Default
= TRUE. If FALSE, <code>initial_distance</code> and <code>increase</code> must be
defined.</p></dd>


<dt>initial_distance</dt>
<dd><p>(numeric) Euclidean distance to be used for a first
process of thinning and detection of remaining blocks. See details in
<code><a href="point_thinning.html">point_thinning</a></code>. Default = NULL.</p></dd>


<dt>increase</dt>
<dd><p>(numeric) initial value to be added to or subtracted from
<code>initial_distance</code> until reaching the number of <code>expected_points</code>.
Default = NULL.</p></dd>


<dt>max_n_samplings</dt>
<dd><p>(numeric) maximum number of samples to be chosen
after performing all thinning <code>replicates</code>. Default = 1.</p></dd>


<dt>replicates</dt>
<dd><p>(numeric) number of thinning replicates performed to
select blocks uniformly. Default = 10.</p></dd>


<dt>use_preselected_sites</dt>
<dd><p>(logical) whether to use sites that have been
defined as part of the selected sites previous any selection. Object in
<code>master</code> must contain the site(s) preselected in in the slot named
"preselected_sites" for this argument to be effective. Default = TRUE.
See details for more information on the approach used.</p></dd>


<dt>select_point</dt>
<dd><p>(character) how or which point will be selected for each
block or cluster. Three options are available: "random", "E_centroid", and
"G_centroid". E_ or G_ centroid indicate that the point(s) closets to the
respective centroid will be selected. Default = "E_centroid".</p></dd>


<dt>cluster_method</dt>
<dd><p>(character) name of the method to be used for detecting
geographic clusters of points inside each block. Options are "hierarchical"
and "k-means"; default = "hierarchical". See details in
<code><a href="find_clusters.html">find_clusters</a></code>.</p></dd>


<dt>median_distance_filter</dt>
<dd><p>(character) optional argument to define a
median distance-based filter based on which sets of sampling sites will be
selected. The default, NULL, does not apply such a filter. Options are:
"max" and "min". See details.</p></dd>


<dt>sample_for_distance</dt>
<dd><p>(numeric) sample to be considered when measuring
the geographic distances among points in blocks created in environmental
space. The distances measured are then used to test whether points are
distributed uniformly or not in the geography. Default = 250.</p></dd>


<dt>set_seed</dt>
<dd><p>(numeric) integer value to specify a initial seed.
Default = 1.</p></dd>


<dt>verbose</dt>
<dd><p>(logical) whether or not to print messages about the process.
Default = TRUE.</p></dd>


<dt>force</dt>
<dd><p>(logical) whether to replace existing set of sites selected
with this method in <code>master</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A <code><a href="master_selection.html">master_selection</a></code> object (S3) with a special element called
selected_sites_EG containing one or more sets of selected sites depending on
<code>max_n_samplings</code> and <code>median_distance_filter</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Two important steps are needed before using this function: 1) exploring data
in environmental and geographic spaces, and 2) performing a regionalization
of the environmental space. Exploring the data can be done using the function
<code><a href="explore_data_EG.html">explore_data_EG</a></code>. This step is optional but strongly
recommended, as important decisions that need to be taken depend on the
of the data in the two spaces. A regionalization of the environmental space
configuration of the region of interest helps in defining important parts of
your region that should be considered to select sites. This can be done
using the function <code><a href="make_blocks.html">make_blocks</a></code>. Later, the regions created in
environmental space will be used for selecting one or more sampling sites per
block depending on the geographic pattern of such environmental combinations.</p>
<p>The process of survey-site selection with this function is the most complex
among all functions in this package. The complexity derives from the aim of
the function, which is to select sites that sample appropriately
environmental combinations in the region of interest (environmental space),
but considering the geographic patterns of such environmental regions
(geographic space).</p>
<p>In this approach, the first step is to select candidate blocks (from the
ones obtained with <code><a href="make_blocks.html">make_blocks</a></code>) that are uniformly distributed
in environmental space. The geographic configuration of points in such
blocks is explored to detect whether they are clustered (i.e., similar
environmental conditions are present in distant places in the region of
interest). For blocks with points that present one cluster in geography,
only one survey site is selected, and for those with multiple clusters in
geographic space, two survey sites are selected considering the two largest
clusters.</p>
<p>If <code>use_preselected_sites</code> is TRUE and such sites are included as an
element in the object in <code>master</code>, the approach for selecting sites in
environmental space considering geographic patterns is a little  different.
User-preselected sites will always be part of the sites selected. Other points
are selected based on an algorithm that searches for sites that are uniformly
distributed in environmental space but at a distance from preselected sites
that helps in maintaining uniformity among environmental blocks selected.
Note that preselected sites will not be processed, therefore, uniformity of
blocks representing such points cannot be warrantied.</p>
<p>As multiple sets could result from selection, the argument of the function
<code>median_distance_filter</code> could be used to select the set of sites with
the maximum ("max") or minimum ("min") median distance among selected sites.
Option "max" will increase the geographic distance among sampling sites,
which could be desirable if the goal is to cover the region of interest more
broadly. The other option, "min", could be used in cases when the goal is to
reduce resources and time needed to sample such sites.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="uniformG_selection.html">uniformG_selection</a></code>, <code><a href="uniformE_selection.html">uniformE_selection</a></code>,
<code><a href="random_selection.html">random_selection</a></code>, <code><a href="make_blocks.html">make_blocks</a></code>,
<code><a href="plot_sites_EG.html">plot_sites_EG</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Data</span></span></span>
<span class="r-in"><span><span class="va">m_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="save_master.html">read_master</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/m_matrix.rds"</span>,</span></span>
<span class="r-in"><span>                                    package <span class="op">=</span> <span class="st">"biosurvey"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Making blocks for analysis</span></span></span>
<span class="r-in"><span><span class="va">m_blocks</span> <span class="op">&lt;-</span> <span class="fu"><a href="make_blocks.html">make_blocks</a></span><span class="op">(</span><span class="va">m_matrix</span>, variable_1 <span class="op">=</span> <span class="st">"PC1"</span>, variable_2 <span class="op">=</span> <span class="st">"PC2"</span>,</span></span>
<span class="r-in"><span>                        n_cols <span class="op">=</span> <span class="fl">10</span>, n_rows <span class="op">=</span> <span class="fl">10</span>, block_type <span class="op">=</span> <span class="st">"equal_area"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Selecting sites considering E and G spaces</span></span></span>
<span class="r-in"><span><span class="va">EG_sel</span> <span class="op">&lt;-</span> <span class="fu">EG_selection</span><span class="op">(</span>master <span class="op">=</span> <span class="va">m_blocks</span>, n_blocks <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                       initial_distance <span class="op">=</span> <span class="fl">1.5</span>, increase <span class="op">=</span> <span class="fl">0.1</span>,</span></span>
<span class="r-in"><span>                       replicates <span class="op">=</span> <span class="fl">1</span>, max_n_samplings <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>                       select_point <span class="op">=</span> <span class="st">"E_centroid"</span>,</span></span>
<span class="r-in"><span>                       cluster_method <span class="op">=</span> <span class="st">"hierarchical"</span>,</span></span>
<span class="r-in"><span>                       sample_for_distance <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Element 'preselected_sites' in 'master' is NULL, setting</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 'use_preselected_sites' = FALSE</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing data for analysis</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Selecting relevant environmental blocks, please wait...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running algorithm for selecting sites, please wait...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     Process 1 of 1</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total number of sites selected: 13</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">EG_sel</span><span class="op">$</span><span class="va">selected_sites_EG</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Longitude Latitude Mean_temperature Max_temperature Min_temperature</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14566  -97.41667 19.91667              180             271              84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17425  -95.91667 17.41667              215             305             128</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 589   -115.25000 32.08333              215             396              49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15327  -97.25000 19.25000              110             208              12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4615  -109.25000 28.58333              197             344              47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17631  -93.25000 17.25000              223             306             138</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Annual_precipitation Prec_wettest_month Prec_driest_month        PC1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14566                 2595                508                73  4.4103564</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17425                 3059                614                61  5.6781935</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 589                     76                 12                 0 -1.4351612</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15327                 1147                219                22 -0.8983117</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4615                   782                208                 8 -0.1402882</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17631                 2491                366                79  4.8642518</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               PC2 Block</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14566  4.32123454    75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17425  3.32007840    96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 589   -2.23368181     1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15327  4.46512880    31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4615   0.03781652    37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 17631  2.52913164    84</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">EG_sel</span><span class="op">$</span><span class="va">selected_sites_EG</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13 11</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Claudia Nuñez-Penichet, Marlon E. Cobos, Jorge Soberón, Tomer Gueta, Narayani Barve, Vijay Barve, Adolfo G. Navarro-Sigüenza, A. Townsend Peterson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

